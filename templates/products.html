{% load static %}
<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cole√ß√£o | Tammy¬¥s Store</title>

    <link rel="icon" type="image/png" href="{% static 'img/favicon.png' %}">
    <link rel="stylesheet" href="{% static 'css/styles.css' %}">

    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Montserrat:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
</head>

<body id="main-body">

    <header class="header">
        <div class="logo">
            <img src="{% static 'img/logo_tammy_clara.png' %}" alt="Logo Tammy">
        </div>

        <nav>
            <a href="/">Home</a>
            <a href="/products/">Cole√ß√£o</a>
            <a href="#novidades">Novidades</a>
            <a href="#lojas">Lojas</a>
            <a href="#contato">Contato</a>

            <a href="/cart/" class="icon-link" aria-label="Carrinho de Compras">
                <i class="fas fa-shopping-bag"></i>
            </a>

            <a href="/admin/" class="icon-link" aria-label="Acesso administrativo">
                <i class="fas fa-user-lock"></i>
            </a>
        </nav>
    </header>

    <main class="products-page-main">
        <h1>Nossa Cole√ß√£o</h1>

        <div id="products-container" class="products-grid">
            <p style="text-align:center; padding: 20px;">Carregando produtos...</p>
        </div>
    </main>

    <section class="feature-section" id="novidades" style="text-align: center; padding: 50px;">
        <h2>‚ú® Destaques e Novidades</h2>
        <div class="feature-item">
            <p>Cores leves, tecidos fluidos e estampas exclusivas. Mais de 50 novas pe√ßas adicionadas ao cat√°logo.</p>
        </div>
    </section>

    <section class="store-location" id="lojas" style="text-align: center; padding: 50px; background-color: #f8f8f8;">
        <h2>üõçÔ∏è Loja F√≠sica em Cotia</h2>

        <p class="address-line">
            Endere√ßo:
            <strong>R. Prof. Jos√© Barreto, 1253 - Loja 10 - Jardim Dinorah, Cotia - SP</strong>
        </p>

        <a href="https://maps.google.com" target="_blank" class="btn primary-btn" style="margin-top: 15px;">
            Abrir Localiza√ß√£o no Mapa
        </a>
    </section>

    <section class="call-to-action" id="contato" style="padding: 50px;">
        <h2>Fale Conosco</h2>
        <form class="newsletter-form">
            <input type="email" placeholder="Seu melhor e-mail" required>
            <button type="submit" class="btn primary-btn">Enviar</button>
        </form>

        <p class="mt-3 contact-info">
            WhatsApp:
            <strong>(11) 99876-5432</strong>
        </p>
    </section>

    <footer class="footer">
        <p>¬© 2024 Tammy¬¥s Store ‚Äî Todos os direitos reservados.</p>
    </footer>

    <script src="{% static 'js/script.js' %}"></script>

    <!-- SCRIPT PARA RENDERIZAR OS PRODUTOS -->
    <script>
        // URL da imagem padr√£o, agora corretamente processada pelo Django
        const NO_IMAGE_URL = "{% static 'img/no-image.png' %}";

        document.addEventListener("DOMContentLoaded", () => {
            const container = document.getElementById("products-container");

            fetch("/api/products/")
                .then(response => response.json())
                .then(products => {
                    container.innerHTML = "";

                    if (products.length === 0) {
                        container.innerHTML = "<p>Nenhum produto dispon√≠vel no momento.</p>";
                        return;
                    }

                    products.forEach(product => {
                        const card = document.createElement("div");
                        card.classList.add("product-card");

                        const imgSrc = product.main_image || NO_IMAGE_URL;

                        card.innerHTML = `
                            <div class="product-img">
                                <img src="${imgSrc}" alt="${product.name}">
                            </div>

                            <h3>${product.name}</h3>
                            <p class="price">R$ ${product.price}</p>
                        `;

                        container.appendChild(card);
                    });
                })
                .catch(err => {
                    container.innerHTML = "<p>Erro ao carregar produtos.</p>";
                    console.error(err);
                });
        });
    </script>

</body>
</html>
